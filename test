# API Specification

This document describes the endpoints, request/response formats, and authentication requirements for the chat backend.

---

## Authentication

All chat endpoints require a Bearer token in the `Authorization` header.  
Obtain a token via the `/login` endpoint.

---

## Endpoints

### 1. Login

**POST** `/login`

Authenticate and receive a bearer token.

**Request Body:**
```json
{
  "username": "your_username",
  "password": "your_password"
}
```

**Response:**
```json
{
  "access_token": "JWT_TOKEN_STRING",
  "token_type": "bearer"
}
```

---

### 2. Chat (Stateless, Resumable)

**POST** `/chat`

Start a new chat session or continue an existing one.  
You must send a `query` (user message).  
To resume a conversation, also send the `state` value you received in the previous response.

**Headers:**
```
Authorization: Bearer <access_token>
Content-Type: application/json
```

**Request Body (new chat):**
```json
{
  "query": "Your question or message"
}
```

**Request Body (resume chat):**
```json
{
  "query": "Your follow-up message",
  "state": "<serialized_state_string_from_previous_response>"
}
```

**Response:**
```json
{
  "response": "Full conversation as a string",
  "state": "<serialized_state_string>",
  "session_id": "session-id-string",
  "error": null
}
```
- `state`: Pass this value back in your next request to resume the conversation.
- `session_id`: For reference; not required unless you want to track sessions.
- `error`: Will be `null` on success, or contain an error message.

---

## Error Responses

- **401 Unauthorized:**  
  ```json
  {
    "detail": "Not authenticated"
  }
  ```

- **400 Bad Request:**  
  (e.g., missing `query` field)
  ```json
  {
    "detail": "No user query provided"
  }
  ```

- **Other errors:**  
  The `error` field in the response will contain details.

---

## Interactive API Docs

You can view and test the API interactively at:  
`/docs` (Swagger UI, auto-generated by FastAPI)

---

## Notes

- Always include the `Authorization` header for chat endpoints.
- The `/chat/stream` endpoint has been removed; all chat is now non-streaming and stateless/resumable.
- Always pass the `state` value from the previous response to resume a conversation.
- If you need to track sessions, you may use the
